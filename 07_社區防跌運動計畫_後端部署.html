<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8"/>
<title>ç¤¾å€è·Œå€’é é˜²åœ˜é«”é‹å‹•è¨ˆç•«</title>
<style>

body { 
  font-family: 'Microsoft JhengHei'; 
  background: #eaf5f2;  
  margin: 0; 
  padding: 0;
  display: flex; 
  justify-content: center; 
    footer { text-align: center; margin-top: 3em; padding-top: 1em; border-top: 1px solid #ccc; font-size: 0.9em; color: #555; }
	.responsive-table {
    overflow-x: auto;
    width: 100%;
}

#attendanceSection {
	  background: #fdfaf4; /* ç±³ç™½è‰²èƒŒæ™¯ */
	  border: 2px solid #ffe082;
	  padding: 1.5em;
	  border-radius: 10px;
	  margin-top: 2em;
	}
.container {
  background: white; 
  padding: 1.5em; 
  border-radius: 10px; 
  box-shadow: 0 0 10px rgba(0,0,0,0.2); 
  max-width: 700px;  /* é€™è£¡æˆ‘å¾åŸæœ¬ 500 èª¿æ•´æˆ 700 */
  width: 100%;
  margin: 1em;
}

h1 {
  color: #004d40;
  font-size: 2.2em;
  font-weight: 700;
  text-align: left;
  border-left: 6px solid #004d40;
  padding-left: 0.5em;
  margin: 0.5em 0 0.5em 0;
}

h2 {
  color: #00695c;
  font-size: 1.4em;
  font-weight: 600;
  padding-left: 0.2em;
  margin-top: 1em;
}



label { 
  display: block; 
  margin-top: 1em; 
  font-weight: bold; 
  font-size: 1em;
}

input[type="text"],
input[type="number"],
select {
  width: 100%;
  padding: 0.5em;
  margin-top: 0.3em;
  box-sizing: border-box;
  font-size: 1em;
}

/* Checkbox alignment */
.checkbox-group label {
  display: flex;
  align-items: center;
  margin-top: 0.5em;
  font-weight: normal;
}

.checkbox-group input[type="checkbox"] {
  margin-right: 0.5em;
  width: 1.2em;
  height: 1.2em;
}

.section { 
  margin-bottom: 2em; 
  padding: 1em; 
  background: #e0f2f1; 
  border-radius: 8px; 
}
.section-yellow { 
  margin-bottom: 2em; 
  padding: 1em; 
  background: #fff9e6; 
  border-radius: 8px; 
}
.section-yellow { margin-bottom: 2em; padding: 1em; background: #fff9e6; border-radius: 8px; }
.output { margin-bottom: 2em; padding: 1em; background: #fff9e6; border-radius: 8px; }


.btn { 
  background: #00897b; 
  color: white; 
  border: none; 
  padding: 0.7em 1.5em; 
  cursor: pointer; 
  border-radius: 5px; 
  margin-top: 1em; 
  font-size: 1em;
}

/* Table Style */
table { 
  width: 100%; 
  border-collapse: collapse; 
  margin-top: 1em; 
  font-size: 0.9em;
}

th, td { 
  border: 1px solid #ccc; 
  padding: 0.5em; 
  text-align: left;
  word-break: break-word;
}

th { 
  background: #009688; 
  color: white; 
}

@media (max-width: 400px) {
  h1, h2 {
    font-size: 1.2em;
  }
  input[type="text"], input[type="number"], select {
    font-size: 0.9em;
  }
  .btn {
    font-size: 0.9em;
  }
}

</style>
</head>
<body>
<div class="container">
<h1>ç¤¾å€è·Œå€’é é˜²åœ˜é«”é‹å‹•è¨ˆç•«</h1>
<div id="Section">
<h2>å€‹æ¡ˆè©•ä¼°</h2>
<form id="personForm">
<label>å§“å <input id="name" required type="text"/></label>
<label>å¹´é½¡ <input id="age" required type="number"/></label>
<label>TUG æ¸¬è©¦ï¼ˆTimed Up and Go ç§’æ•¸ï¼‰<input id="tugSec" required type="number"/></label>
<label>æ˜¯å¦æ›¾è·Œå€’ï¼Ÿ<input id="fall" type="checkbox"/> æ›¾è·Œå€’</label>
<label>ä½¿ç”¨åŠ©è¡Œå™¨ï¼ˆå¯è¤‡é¸ï¼‰ï¼š<br/>
<input name="aid" type="checkbox" value="åŠ©è¡Œå™¨"/> åŠ©è¡Œå™¨
<input name="aid" type="checkbox" value="å››è…³æ‹"/> å››è…³æ‹
<input name="aid" type="checkbox" value="å–®è…³æ‹"/> å–®è…³æ‹
<input name="aid" type="checkbox" value="å…¶ä»–"/> å…¶ä»–</label>
<label>ç–¼ç—›ç¨‹åº¦ï¼š<select id="pain">
<option value="ç„¡">ç„¡</option>
<option value="è¼•åº¦">è¼•åº¦</option>
<option value="ä¸­åº¦">ä¸­åº¦</option>
<option value="é‡åº¦">é‡åº¦</option>
</select></label>
<h2>é‹å‹•å‰è©•ä¼°è¡¨</h2>
<table>
<thead><tr><th>è©•é‡é …ç›®</th><th>æ˜¯</th><th>å¦</th></tr></thead>
<tbody>
<tr><td>é†«å¸«å‘ŠçŸ¥å¿ƒè‡Ÿå•é¡Œï¼Œåªèƒ½åšé†«å¸«å»ºè­°é‹å‹•ï¼Ÿ</td><td><input type="radio" name="q1" value="æ˜¯"></td><td><input type="radio" name="q1" value="å¦"></td></tr>
<tr><td>æ´»å‹•æ™‚æœƒæœ‰èƒ¸ç—›çš„æ„Ÿè¦ºï¼Ÿ</td><td><input type="radio" name="q2" value="æ˜¯"></td><td><input type="radio" name="q2" value="å¦"></td></tr>
<tr><td>éå»3å€‹æœˆå…§ï¼Œæœªæ´»å‹•æ™‚ä¹Ÿæœ‰èƒ¸ç—›çš„æƒ…å½¢ï¼Ÿ</td><td><input type="radio" name="q3" value="æ˜¯"></td><td><input type="radio" name="q3" value="å¦"></td></tr>
<tr><td>æ›¾æœ‰æšˆçœ©å°è‡´å¤±å»å¹³è¡¡æˆ–æ„è­˜çš„æƒ…æ³ï¼Ÿ</td><td><input type="radio" name="q4" value="æ˜¯"></td><td><input type="radio" name="q4" value="å¦"></td></tr>
<tr><td>æ˜¯å¦æœ‰éª¨éª¼æˆ–é—œç¯€å•é¡Œï¼Œå¯èƒ½å› æ´»å‹•æƒ¡åŒ–ï¼Ÿ</td><td><input type="radio" name="q5" value="æ˜¯"></td><td><input type="radio" name="q5" value="å¦"></td></tr>
<tr><td>å› é«˜è¡€å£“æˆ–å¿ƒè‡Ÿç–¾ç—…è€Œéœ€è¦æœè—¥æ²»ç™‚(é†«å¸«è™•æ–¹)ï¼Ÿ</td><td><input type="radio" name="q6" value="æ˜¯"></td><td><input type="radio" name="q6" value="å¦"></td></tr>
<tr><td>æœ‰ä»»ä½•ä¸é©åˆæ´»å‹•çš„åŸå› ï¼Ÿ</td><td><input type="radio" name="q7" value="æ˜¯"></td><td><input type="radio" name="q7" value="å¦"></td></tr>
</tbody>
</table>
<button class="btn" type="button" onclick="addPerson()">â• åŠ å…¥å€‹æ¡ˆ</button>
<button class="btn" type="button" onclick="shareToLINE()">ğŸ“² æ­¤ä½å€‹æ¡ˆåˆ†äº«è‡³ LINE</button>
</form><br>
<table id="personTable">
<thead><tr><th>å§“å</th><th>å¹´é½¡</th><th>TUGï¼ˆç§’ï¼‰</th><th>è·Œå€’å²</th><th>åŠ©è¡Œå™¨</th><th>ç–¼ç—›</th><th>åˆ†æ•¸</th><th>åˆ†ç¾¤</th><th>å®‰å…¨è©•ä¼°å»ºè­°</th><th>ç§»é™¤</th></tr></thead>
<tbody></tbody>
</table>
<br><div class="output" id="groupSummary"></div>
<button class="btn" onclick="exportExcel()">ğŸ“¥ ç¾¤é«”è©•ä¼°è³‡æ–™åŒ¯å‡º Excel</button>
</div>
<div id="attendanceSection" class="section-yellow">
<h2>ğŸ“† é‹å‹•è¨ˆç•«é€±æ¬¡è¨˜éŒ„</h2>
<p>è«‹ç´€éŒ„æ¯ä½å€‹æ¡ˆæ¯é€±å‡ºå¸­æƒ…æ³èˆ‡è¨“ç·´é …ç›®ã€‚</p>
<table id="attendanceTable" >
<thead><tr><th>é€±æ¬¡æˆ–æ—¥æœŸ</th><th>å‡ºå¸­äººæ•¸</th><th>è¨“ç·´å…§å®¹</th><th>æŒ‡å°å“¡</th><th>å‚™è¨»</th><th>ç§»é™¤</th></tr></thead> 
<tbody><tr>
<td><input placeholder="é€±æ¬¡" type="text"/></td>
<td><input placeholder="äººæ•¸" type="number"/></td>
<td><input placeholder="å¦‚ å¹³è¡¡è¨“ç·´ã€æ‹‰ç­‹ç­‰" type="text"/></td>
<td><input placeholder="æŒ‡å°å“¡" type="text"/></td>
<td><input placeholder="å‚™è¨»" type="text"/></td>
</tr></tbody></table>
<button class="btn" onclick="addAttendanceRow()">â• æ–°å¢é€±æ¬¡è¨˜éŒ„</button>
<button class="btn" onclick="exportAttendance()">ğŸ“¤ åŒ¯å‡ºé‹å‹•è¨˜éŒ„ Excel</button>
</div>
<footer>ç”± Contrario Ish è¨­è¨ˆèˆ‡è£½ä½œï¼Œç‰ˆæ¬Šæ‰€æœ‰ Â© 2024</footer>
</div>
<script>
let people = JSON.parse(localStorage.getItem("people")) || [];
updateTable();
updateGroupSummary();

async function addPerson() {
  const name = document.getElementById("name").value;
  const age = document.getElementById("age").value;
  const tugSec = parseFloat(document.getElementById("tugSec").value);
  const fall = document.getElementById("fall").checked ? 1 : 0;
  const aids = Array.from(document.querySelectorAll("input[name='aid']:checked")).map(cb => cb.value);
  const aid = aids.length > 0 ? aids.join("ã€") : "ç„¡";
  const pain = document.getElementById("pain").value;
  const answers = Array.from(document.querySelectorAll("#personForm input[type='radio']:checked")).map(el => el.value);

  const requestData = {
    TUG: tugSec,
    Fall: fall,
    Aid: aid,
    Pain: pain
  };

  try {
    const response = await fetch("https://script.google.com/macros/s/AKfycbxbfmwa6gGOZMwalglVsrkdRXqnJKB98wo9FZf8VwbmO4VF4tD3rkrf0x6awlh524m_cA/exec", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(requestData)
    });

    const result = await response.json();

    people.push({
      name, age, tug: tugSec, fall: fall ? "æ˜¯" : "å¦",
      aid, pain, score: result.score, group: result.group, assessmentResult: result.safeAdvice
    });

    localStorage.setItem("people", JSON.stringify(people));
    updateTable();
    updateGroupSummary();
    document.getElementById("personForm").reset();

  } catch (error) {
    console.error("å¾Œç«¯å‘¼å«å¤±æ•—ï¼š", error);
    alert("âš ï¸ ç³»çµ±æš«æ™‚ç„¡æ³•å–å¾—å»ºè­°ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚");
  }
}

function updateTable() {
  const tbody = document.querySelector("#personTable tbody");
  tbody.innerHTML = "";
  people.forEach((p, index) => {
    const tr = document.createElement("tr");
    tr.innerHTML = `<td>${p.name}</td><td>${p.age}</td><td>${p.tug}</td><td>${p.fall}</td><td>${p.aid}</td><td>${p.pain}</td><td>${p.score}</td><td>${p.group}</td><td>${p.assessmentResult}</td><td><button onclick="removePerson(${index})">âŒ</button></td>`;
    tbody.appendChild(tr);
  });
}
function removePerson(index) {
  people.splice(index, 1);
  localStorage.setItem("people", JSON.stringify(people));
  updateTable(); updateGroupSummary();
}
function updateGroupSummary() {
  const summary = {};
  people.forEach(p => { if (!summary[p.group]) summary[p.group] = []; summary[p.group].push(p.name); });
  let result = "ğŸ‘¥ åˆ†ç¾¤çµæœï¼š\n";
  for (const g in summary) { result += `ã€${g}ã€‘\n- ${summary[g].join("ï¼Œ")}\n`; }
  result += "\nğŸ“Œ å®¢è£½åŒ–é‹å‹•å»ºè­°ï¼š\né«”èƒ½è¼ƒä½³çµ„ï¼šèµ°è·¯è¨“ç·´ã€éšæ¢¯è¨“ç·´ã€å‹•æ…‹å¹³è¡¡è¨“ç·´\né«”èƒ½è¼ƒå·®çµ„ï¼šæ¤…ä¸Šé‹å‹•ã€ç°¡åŒ–å¾’æ‰‹é‹å‹•ã€éœæ…‹å¹³è¡¡\né«”èƒ½å·®ä¸”ç–¼ç—›å•é¡Œçµ„ï¼šç‰©ç†æ²»ç™‚ä»‹å…¥èˆ‡è¼”å…·é‹ç”¨";
  document.getElementById("groupSummary").innerText = result;
}
function exportExcel() {
  let csv = "å§“å,å¹´é½¡,TUG(ç§’),è·Œå€’å²,åŠ©è¡Œå™¨,ç–¼ç—›,åˆ†æ•¸,åˆ†ç¾¤,å®‰å…¨è©•ä¼°å»ºè­°\n";
  people.forEach(p => { csv += `${p.name},${p.age},${p.tug},${p.fall},${p.aid},${p.pain},${p.score},${p.group},${p.assessmentResult}\n`; });
  downloadCSV(csv, 'ç¾¤é«”è©•ä¼°è³‡æ–™.csv');
}
function shareToLINE() {
  if (people.length === 0) { alert("ç›®å‰æ²’æœ‰å€‹æ¡ˆè³‡æ–™å¯ä¾›å‚³é€"); return; }
  const p = people[people.length - 1];
  const msg = encodeURIComponent(`ğŸ“‹ ${p.name} åˆ†ç¾¤ï¼š${p.group}\nå»ºè­°ï¼š${p.assessmentResult}`);
  window.open(`https://line.me/R/msg/text/?${msg}`, "_blank");
}
function addAttendanceRow() {
  const tbody = document.querySelector("#attendanceTable tbody");
  const row = document.createElement("tr");
  row.innerHTML = `
    <td><input type='text' placeholder='é€±æ¬¡'/></td>
    <td><input type='number' placeholder='äººæ•¸'/></td>
    <td><input type='text' placeholder='è¨“ç·´å…§å®¹'/></td>
    <td><input type='text' placeholder='æŒ‡å°å“¡'/></td>
    <td><input type='text' placeholder='å‚™è¨»'/></td>
    <td><button onclick="removeAttendanceRow(this)">âŒ</button></td>
  `;
  tbody.appendChild(row);
  saveAttendanceData();
}

function removeAttendanceRow(button) {
  const row = button.closest("tr");
  row.remove();
  saveAttendanceData();
}

function saveAttendanceData() {
  const rows = document.querySelectorAll("#attendanceTable tbody tr");
  const data = [];
  rows.forEach(row => {
    const inputs = row.querySelectorAll("input");
    const rowData = Array.from(inputs).map(input => input.value);
    data.push(rowData);
  });
  localStorage.setItem("attendanceData", JSON.stringify(data));
}

function loadAttendanceData() {
  const stored = localStorage.getItem("attendanceData");
  if (stored) {
    const data = JSON.parse(stored);
    const tbody = document.querySelector("#attendanceTable tbody");
    tbody.innerHTML = "";
    data.forEach(rowData => {
      const row = document.createElement("tr");
      row.innerHTML = `
        <td><input type='text' placeholder='é€±æ¬¡æˆ–æ—¥æœŸ' value='${rowData[0]}'/></td>
        <td><input type='number' placeholder='äººæ•¸' value='${rowData[1]}'/></td>
        <td><input type='text' placeholder='è¨“ç·´å…§å®¹' value='${rowData[2]}'/></td>
        <td><input type='text' placeholder='æŒ‡å°å“¡' value='${rowData[3]}'/></td>
        <td><input type='text' placeholder='å‚™è¨»' value='${rowData[4]}'/></td>
        <td><button onclick="removeAttendanceRow(this)">âŒ</button></td>
      `;
      tbody.appendChild(row);
    });
  }
}

document.addEventListener("input", function(e) {
  if (e.target.closest("#attendanceTable")) {
    saveAttendanceData();
  }
});

window.onload = function() {
  loadAttendanceData();
};

function exportAttendance() {
  const rows = document.querySelectorAll("#attendanceTable tbody tr");
  let csv = "é€±æ¬¡,å‡ºå¸­äººæ•¸,è¨“ç·´å…§å®¹,æŒ‡å°å“¡,å‚™è¨»\n";
  rows.forEach(row => {
    const data = Array.from(row.querySelectorAll("input")).map(input => input.value);
    csv += data.join(",") + "\n";
  });
  downloadCSV(csv, 'attendance_record.csv');
}
function downloadCSV(csv, filename) {
  const blob = new Blob(["\uFEFF" + csv], { type: "text/csv;charset=utf-8;" });
  const link = document.createElement("a");
  link.href = URL.createObjectURL(blob);
  link.download = filename;
  link.click();
}
</script>
</body>
</html>
</html>